# Исправление логирования проб

## Что было сделано:

1. **Улучшен код пробы для Python:**
   - Добавлено логирование URL, который используется
   - Добавлен полный traceback при ошибках
   - Улучшено логирование успешных запросов
   - **ДОБАВЛЕНО: параллельное логирование в консоль (stderr)** - теперь видно выполнение проб в реальном времени
   - Логи выводятся в формате: `[RooTrace Probe] Probe EXECUTING: H1 - message, URL: ...`
   - Логи выводятся в формате: `[RooTrace Probe] Probe SUCCESS: H1 - status=200, URL: ...`
   - Ошибки выводятся в формате: `[RooTrace Probe ERROR] Probe ERROR: H1 - ...`

2. **Улучшен код пробы для JavaScript/TypeScript:**
   - Добавлено логирование в консоль через `console.error`
   - Логи выводятся в формате: `[RooTrace Probe] EXECUTING: H1 - message, URL: ...`

3. **Добавлено логирование при генерации кода проб:**
   - В Output Channel "AI Debugger" теперь видно, какой URL используется при генерации кода пробы

4. **Создан тестовый скрипт:**
   - `test-probe-code.py` - для проверки работы кода пробы напрямую

## Как применить изменения:

1. **Перекомпилируйте проект:**
   ```bash
   npm run compile
   ```

2. **Перезагрузите окно VS Code:**
   - Cmd+Shift+P -> "Developer: Reload Window"

3. **Проверьте работу:**
   - Запустите ваш код с пробами
   - **Теперь логи выводятся в консоль (stderr) в реальном времени!**
   - Вы должны увидеть в консоли:
     ```
     [RooTrace Probe] Probe EXECUTING: H1 - Your message, URL: http://localhost:51234/
     [RooTrace Probe] Probe SUCCESS: H1 - status=200, URL=http://localhost:51234/
     ```
   - Также проверьте файл `~/.roo_probe_debug.log`:
     ```bash
     tail -f ~/.roo_probe_debug.log
     ```

## Диагностика проблем:

### Если файл `~/.roo_probe_debug.log` не создается:
- Код проб не выполняется (не доходит до места вставки)
- Проверьте, что код выполняется до места вставки пробы
- Проверьте, что проба вставлена в правильное место

### Если файл создается, но содержит ошибки:
- Проверьте URL в логах - он должен быть `http://localhost:51234/`
- Проверьте, что сервер запущен (используйте `test-probe-connection.py`)
- Проверьте traceback в логах для деталей ошибки

### Если логи показывают SUCCESS, но логи не появляются в дашборде:
- Проверьте логи сервера в Output Channel "AI Debugger"
- Ищите строки вида `[HTTP SERVER] POST request received on /`
- Проверьте, что сервер обрабатывает запросы правильно

## Тестирование:

1. **Тест подключения к серверу:**
   ```bash
   python3 test-probe-connection.py
   ```

2. **Тест кода пробы:**
   ```bash
   python3 test-probe-code.py
   ```

3. **Проверка логов в реальном времени:**
   ```bash
   tail -f ~/.roo_probe_debug.log
   ```
