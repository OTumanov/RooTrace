# üåê PHASE 2: –û–ë–ù–ê–†–£–ñ–ï–ù–ò–ï –°–ï–¢–ò

**üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ü–µ—Ä–µ–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π —Ç—ã –û–ë–Ø–ó–ê–ù –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π endpoint —Å–µ—Ä–≤–µ—Ä–∞. –ó–ê–ü–†–ï–©–ï–ù–û —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å `localhost:51234`!

**–í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø:** –ü–û–°–õ–ï Phase 0.4 (Pre-Flight Check), –ü–ï–†–ï–î Phase 2.2 (Smoke Test).

---

## üéØ –ù–ê–ó–ù–ê–ß–ï–ù–ò–ï

Phase 2 - —ç—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ endpoint —Å–µ—Ä–≤–µ—Ä–∞ RooTrace. –¶–µ–ª—å - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å FINAL_HOST –∏ ACTUAL_PORT –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (–ø—Ä–æ–±—ã, smoke test).

---

## üìã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –®–ê–ì–ò

### 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ—Ä—Ç

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ—Ä—Ç `51234`. –ù–µ –∏—â–∏ —Ñ–∞–π–ª—ã, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–π –Ω–∏—á–µ–≥–æ.

**ACTUAL_PORT = 51234**

**–í–´–í–û–î:** `PORT: 51234`

---

### 2. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ Docker –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø—Ä–æ–µ–∫—Ç—É:

**–®–ê–ì–ò:**
1. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞–ª–∏—á–∏–µ Docker —Ñ–∞–π–ª–æ–≤ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ `read_file` –∏–ª–∏ `list_directory`:
   - –ò—â–∏ `Dockerfile`, `docker-compose.yml`, `docker-compose.yaml`, `.dockerignore`
   - –ï—Å–ª–∏ –õ–Æ–ë–û–ô –∏–∑ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –ø—Ä–æ–≤–µ—Ä—å Docker (–ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Docker)

2. **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ï—Å–ª–∏ Docker —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã, –æ–ø—Ä–µ–¥–µ–ª–∏ –æ–±—Ä–∞–∑—ã –∏–∑ –Ω–∏—Ö:
   - –ü—Ä–æ—á–∏—Ç–∞–π `docker-compose.yml` —á–µ—Ä–µ–∑ `read_file(path="docker-compose.yml")`
   - –ù–∞–π–¥–∏ –∏–º–µ–Ω–∞ –æ–±—Ä–∞–∑–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `image: ifc-app`, `image: ifc-ifc-cutter`)
   - –ò–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–π `Dockerfile` –∏ –Ω–∞–π–¥–∏ –∏–º—è –æ–±—Ä–∞–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `FROM node:18` –∏–ª–∏ `FROM python:3.11`)

3. –ó–∞–ø—É—Å—Ç–∏ `docker ps` —á–µ—Ä–µ–∑ `execute_command` –∏ –ø—Ä–æ–≤–µ—Ä—å, –µ—Å—Ç—å –ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –æ–±—Ä–∞–∑–∞–º–∏ –∏–∑ —à–∞–≥–∞ 2:
   - –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–∞–π–¥–µ–Ω—ã —Å –æ–±—Ä–∞–∑–∞–º–∏ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ Docker bridge (—à–∞–≥ 3)
   - –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ù–ï –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí `FINAL_HOST = "localhost"` (–ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ)

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π Docker, –µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞! –ü—Ä–æ–≤–µ—Ä—è–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–∑–æ–≤ –∏–∑ docker-compose.yml/Dockerfile –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º –≤ `docker ps`.

**–í–´–í–û–î:** `ENV: [docker/local]` –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–∏—á–∏—è Docker —Ñ–∞–π–ª–æ–≤ –ò —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø—Ä–æ–µ–∫—Ç—É

**–®–¢–†–ê–§:** –ü—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ Docker –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Docker —Ñ–∞–π–ª–æ–≤ = +10 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)
**–®–¢–†–ê–§:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ = +15 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

---

### 3. –°–µ—Ç–µ–≤–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞ (Docker Bridge) (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ï–°–õ–ò DOCKER –û–ë–ù–ê–†–£–ñ–ï–ù)

**–ï–°–õ–ò Docker —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ò–õ–ò `docker ps` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –¢—ã –î–û–õ–ñ–ï–ù –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Docker bridge. –ù–ï –ü–†–û–ü–£–°–ö–ê–ô —ç—Ç–æ—Ç —à–∞–≥!

**–®–ê–ì–ò:**
1. –ü–æ–ª—É—á–∏ `CONTAINER_ID` –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
   - –ü–æ–ø—Ä–æ–±—É–π: `docker ps --format "{{.ID}}" --filter "ancestor=<app_image>"` (–µ—Å–ª–∏ –∑–Ω–∞–µ—à—å –∏–º—è –æ–±—Ä–∞–∑–∞)
   - –ò–ª–∏: `docker ps --format "{{.ID}}"` –∏ –≤—ã–±–µ—Ä–∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
   - –ò–ª–∏: `docker ps -q` —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

2. **–í–´–ü–û–õ–ù–ò:** `docker exec <CONTAINER_ID> curl -s -o /dev/null -w "%{http_code}" http://host.docker.internal:<ACTUAL_PORT>/` —á–µ—Ä–µ–∑ `execute_command`

3. **–û–ü–†–ï–î–ï–õ–ï–ù–ò–ï FINAL_HOST:**
   - –ï—Å–ª–∏ HTTP –∫–æ–¥ `200/404/405` (—Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç): `FINAL_HOST = "host.docker.internal"`
   - –ò–Ω–∞—á–µ –µ—Å–ª–∏ –ø—Ä–æ–≤–∞–ª–∏–ª–æ—Å—å (connection refused/timeout): –ü–æ–ø—Ä–æ–±—É–π `FINAL_HOST = "172.17.0.1"` (Linux bridge) –∏ –ø—Ä–æ–≤–µ—Ä—å —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ `docker exec <CONTAINER_ID> curl -s -o /dev/null -w "%{http_code}" http://172.17.0.1:<ACTUAL_PORT>/`

**–í–´–í–û–î:** `DOCKER_BRIDGE: [host.docker.internal|172.17.0.1|failed]`

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –ï—Å–ª–∏ Docker —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –Ω–æ —Ç—ã –ø—Ä–æ–ø—É—Å—Ç–∏–ª –ø—Ä–æ–≤–µ—Ä–∫—É Docker bridge ‚Üí +10 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

**–ï–°–õ–ò Docker —Ñ–∞–π–ª–æ–≤ –ù–ï–¢ –ò `docker ps` –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
- `FINAL_HOST = "localhost"`
- **–í–´–í–û–î:** `DOCKER_BRIDGE: not needed (local environment)`

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**
- –°–æ—Ö—Ä–∞–Ω–∏ `FINAL_HOST` –∏ `ACTUAL_PORT` –≤ —Å–≤–æ–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–ª—è –í–°–ï–• –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –ø—Ä–æ–±
- –°–æ–æ–±—â–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: `[RooTrace] Discovery complete. Using http://<FINAL_HOST>:<ACTUAL_PORT>`
- **–í–´–í–û–î:** `NETWORK: http://<FINAL_HOST>:<ACTUAL_PORT>`

---

### 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–±–∞—Ö (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û)

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –ü–µ—Ä–µ–¥–∞–≤–∞–π –æ–±–∞ `FINAL_HOST` –∏ `ACTUAL_PORT` –≤ –ö–ê–ñ–î–´–ô —à–∞–±–ª–æ–Ω `probeCode`, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—à—å.

**–ó–ê–ü–†–ï–©–ï–ù–û:** –•–∞—Ä–¥–∫–æ–¥–∏—Ç—å `localhost:51234` –≤ –∫–æ–¥–µ –ø—Ä–æ–±.

**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: `http://<FINAL_HOST>:<ACTUAL_PORT>/` –≤–æ –≤—Å–µ—Ö –ø—Ä–æ–±–∞—Ö.

**–ü–†–ò–ú–ï–†–´ –®–ê–ë–õ–û–ù–û–í –ü–†–û–ë:**

**Python:**
```python
target_host = "{{FINAL_HOST}}"  # –ë—É–¥–µ—Ç "host.docker.internal" –∏–ª–∏ "localhost"
target_port = {{ACTUAL_PORT}}   # –ë—É–¥–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç –∏–∑ .debug_port
conn = http.client.HTTPConnection(target_host, target_port)
```

**Go:**
```go
serverURL := fmt.Sprintf("http://%s:%d/", "{{FINAL_HOST}}", {{ACTUAL_PORT}})
```

---

## üö® –®–¢–†–ê–§–´

**–®–¢–†–ê–§:** –•–∞—Ä–¥–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ `localhost:51234` –≤–º–µ—Å—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π = +15 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

**–®–¢–†–ê–§:** –ü—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ Docker –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Docker —Ñ–∞–π–ª–æ–≤ = +10 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

**–®–¢–†–ê–§:** –ü—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ Docker bridge –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ Docker = +10 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

**–®–¢–†–ê–§:** –ü—Ä–æ–ø—É—Å–∫ Phase 2 (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ç–∏) = +20 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE)

**üö® CRITICAL FAILURE: –ü—Ä–æ–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ `.rootrace/debug_port` –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ `.debug_port` = +15 –±–∞–ª–ª–æ–≤ (CRITICAL FAILURE) - –ø—Ä–æ–≤–µ—Ä—è–π –û–ë–ê –ø—É—Ç–∏!**

---

## üìö –°–í–Ø–ó–ê–ù–ù–´–ï –ú–û–î–£–õ–ò

- `roo-04-preflight.md` - Phase 0.4: Pre-Flight Check (–ø—Ä–µ–¥—ã–¥—É—â–∏–π —à–∞–≥)
- `roo-07-smoke-test.md` - Phase 2.2: Smoke Test (—Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥)
- `code-01-probe-insertion.md` - Phase 1.1: –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å—Ç–∞–≤–∫–∏ –ø—Ä–æ–± (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç FINAL_HOST –∏ ACTUAL_PORT)
- `00-help-operations.md` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º `read_file`, `execute_command`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-23
